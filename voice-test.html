<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice Test</title>
<style>
body{font-family:-apple-system,sans-serif;padding:20px;background:#f5f5f5}
h2{margin-bottom:10px}
#result{background:#fff;padding:16px;border-radius:12px;margin-top:12px;font-size:14px;line-height:2;white-space:pre-wrap}
button{padding:12px 24px;font-size:16px;border:none;border-radius:8px;background:#3498db;color:#fff;margin:6px;cursor:pointer}
.ko{color:#e74c3c;font-weight:bold}
</style>
</head>
<body>
<h2>Korean TTS Voices</h2>
<button onclick="check()">Check Voices</button>
<button onclick="testAll()">Play All</button>
<button onclick="previewPopup()">Preview TTS Popup</button>
<div id="result">Tap "Check Voices" to see available Korean voices.</div>
<div id="popupArea"></div>
<script>
function previewPopup(){
  var langs = ['en','ko','cn','ja','es','fr','pt','de','id','ms','th','vi'];
  var html = '<h3 style="margin:16px 0 8px">Select language to preview popup:</h3>';
  for(var i=0;i<langs.length;i++){
    html += '<button onclick="showPreview(\''+langs[i]+'\')" style="margin:4px;padding:8px 16px;border-radius:8px;border:1px solid #3498db;background:#fff;color:#3498db;font-size:14px;cursor:pointer">'+langs[i]+'</button>';
  }
  document.getElementById('popupArea').innerHTML = html;
}

var ttsPromptText = {
  en: { msg: "Korean voice is not installed on your device.\nTo hear Korean dialogues, please install a Korean voice pack.", install: "How to Install", skip: "Continue without voice" },
  ko: { msg: "í•œêµ­ì–´ ìŒì„±ì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.\nëŒ€í™”ë¬¸ì„ ë“£ê¸° ìœ„í•´ í•œêµ­ì–´ ìŒì„±íŒ©ì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.", install: "ì„¤ì¹˜ ë°©ë²• ë³´ê¸°", skip: "ìŒì„± ì—†ì´ ê³„ì†í•˜ê¸°" },
  cn: { msg: "æ‚¨çš„è®¾å¤‡æœªå®‰è£…éŸ©è¯­è¯­éŸ³ã€‚\nè¯·å®‰è£…éŸ©è¯­è¯­éŸ³åŒ…ä»¥æ”¶å¬å¯¹è¯ã€‚", install: "æŸ¥çœ‹å®‰è£…æ–¹æ³•", skip: "è·³è¿‡ï¼Œç»§ç»­ä½¿ç”¨" },
  ja: { msg: "éŸ“å›½èªã®éŸ³å£°ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nä¼šè©±ã‚’èãã«ã¯éŸ“å›½èªéŸ³å£°ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚", install: "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•", skip: "éŸ³å£°ãªã—ã§ç¶šã‘ã‚‹" },
  es: { msg: "No hay voz coreana instalada.\nInstale el paquete de voz coreana para escuchar los diÃ¡logos.", install: "CÃ³mo instalar", skip: "Continuar sin voz" },
  fr: { msg: "Aucune voix corÃ©enne installÃ©e.\nInstallez le pack vocal corÃ©en pour Ã©couter les dialogues.", install: "Comment installer", skip: "Continuer sans voix" },
  pt: { msg: "Voz coreana nÃ£o instalada.\nInstale o pacote de voz coreana para ouvir os diÃ¡logos.", install: "Como instalar", skip: "Continuar sem voz" },
  de: { msg: "Keine koreanische Stimme installiert.\nInstallieren Sie das koreanische Sprachpaket.", install: "Installationsanleitung", skip: "Ohne Stimme fortfahren" },
  id: { msg: "Suara Korea belum terpasang.\nPasang paket suara Korea untuk mendengar dialog.", install: "Cara memasang", skip: "Lanjutkan tanpa suara" },
  ms: { msg: "Suara Korea belum dipasang.\nSila pasang pakej suara Korea untuk mendengar dialog.", install: "Cara memasang", skip: "Teruskan tanpa suara" },
  th: { msg: "à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹€à¸ªà¸µà¸¢à¸‡à¸ à¸²à¸©à¸²à¹€à¸à¸²à¸«à¸¥à¸µ\nà¸à¸£à¸¸à¸“à¸²à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹€à¸à¸·à¹ˆà¸­à¸Ÿà¸±à¸‡à¸šà¸—à¸ªà¸™à¸—à¸™à¸²", install: "à¸§à¸´à¸˜à¸µà¸•à¸´à¸”à¸•à¸±à¹‰à¸‡", skip: "à¸”à¸³à¹€à¸™à¸´à¸™à¸•à¹ˆà¸­à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸¡à¸µà¹€à¸ªà¸µà¸¢à¸‡" },
  vi: { msg: "ChÆ°a cÃ i giá»ng tiáº¿ng HÃ n.\nHÃ£y cÃ i Ä‘áº·t Ä‘á»ƒ nghe há»™i thoáº¡i.", install: "CÃ¡ch cÃ i Ä‘áº·t", skip: "Tiáº¿p tá»¥c khÃ´ng cÃ³ giá»ng nÃ³i" }
};

function showPreview(lang){
  var old = document.getElementById('ttsPrompt');
  if(old) old.remove();
  var t = ttsPromptText[lang] || ttsPromptText.en;
  var overlay = document.createElement('div');
  overlay.id = 'ttsPrompt';
  overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;';
  var box = document.createElement('div');
  box.style.cssText = 'background:#fff;border-radius:16px;padding:24px;max-width:340px;width:100%;text-align:center;box-shadow:0 8px 30px rgba(0,0,0,0.2);';
  box.innerHTML = '<div style="font-size:48px;margin-bottom:12px;">ğŸ”Š</div>' +
    '<div style="font-size:14px;color:#333;line-height:1.7;white-space:pre-line;margin-bottom:20px;">' + t.msg + '</div>' +
    '<a href="tts-guide.html?lang=' + lang + '" target="_blank" style="display:block;padding:12px;background:#3498db;color:#fff;border-radius:10px;text-decoration:none;font-size:15px;font-weight:700;margin-bottom:10px;">' + t.install + '</a>' +
    '<button id="ttsSkipBtn" style="display:block;width:100%;padding:10px;background:none;border:1px solid #ccc;border-radius:10px;color:#888;font-size:13px;cursor:pointer;">' + t.skip + '</button>';
  overlay.appendChild(box);
  document.body.appendChild(overlay);
  document.getElementById('ttsSkipBtn').addEventListener('click', function(){ overlay.remove(); });
}
function check(){
  var voices = speechSynthesis.getVoices();
  var ko = voices.filter(function(v){return v.lang.indexOf('ko')!==-1;});
  var all = voices.length;
  var html = 'Total voices: ' + all + '\nKorean voices: ' + ko.length + '\n\n';
  if(ko.length===0){
    html += '(No Korean voices found. Try tapping again after 1 second.)';
  }
  for(var i=0;i<ko.length;i++){
    var v=ko[i];
    html += (i+1) + '. ' + v.name + '\n   lang=' + v.lang + '  local=' + v.localService + '\n\n';
  }
  html += '--- All voices ---\n';
  for(var j=0;j<voices.length;j++){
    html += voices[j].lang + ' : ' + voices[j].name + '\n';
  }
  document.getElementById('result').innerHTML = html;
}
function testAll(){
  var voices = speechSynthesis.getVoices();
  var ko = voices.filter(function(v){return v.lang.indexOf('ko')!==-1;});
  if(ko.length===0){check();return;}
  var text = 'ì•ˆë…•í•˜ì„¸ìš”, í•œêµ­ì–´ ìŒì„± í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.';
  var i=0;
  function playNext(){
    if(i>=ko.length)return;
    var u=new SpeechSynthesisUtterance(text);
    u.voice=ko[i];
    u.rate=1.0;
    u.onend=function(){i++;playNext();};
    document.getElementById('result').innerHTML='Playing: ' + ko[i].name;
    speechSynthesis.speak(u);
  }
  speechSynthesis.cancel();
  playNext();
}
setTimeout(check, 500);
</script>
</body>
</html>
